---
import Card from "../components/Card.astro";
import Layout from "../layouts/Layout.astro";
import TopArtists from "../components/TopArtists.astro"
import Genres from "../components/Genres.astro"
import Track from "../components/Track.astro";
import {supabase} from "../database"
const {data} = await supabase.from("tracks").select("*,albums(album_name,id_author:artists(artist_name))")
const tracks = data
---

<Layout title="Soundwave">
	<div class="flex flex-col gap-8">
		<div class="max-sm:flex-col flex gap-8">
			<Card title="Daily Mix" text="New mixes everyday" url="/man-listen1.png" bgcolor="bg-yellow-400" />
			<Card title="Liked Songs" text="Your favorite tracks" url="/man-listen2.png" bgcolor="bg-blue-900" />
		</div>
		<div class="bg-zinc-900 p-8 rounded-3xl mb-28 flex flex-col gap-9">
			{
				tracks?.map(track=>(<Track trackid={track.id} src={track.track_url} title={track.track_name} thumbnail={track.track_thumbnail} author={track.albums?.id_author?.artist_name} />))
			}
		</div>
	</div>
	<div class="max-md:hidden basis-1/3">
		<div class="flex flex-col gap-12">
			<TopArtists />
			<Genres />
		</div>
	</div>
</Layout>